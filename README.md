# Soybean_small_large_scale

This repository contains R scripts used for amplicon-based microbiome analyses in a soybean developmental stage study.  
The pipeline covers raw 16S rRNA amplicon sequence processing, microbial community ecology analyses, and source‚Äìsink inference across developmental stages.

All scripts were used to generate results reported in the associated manuscript.

---

## üìÅ Repository contents

### 1. `01_dada2_processing_Large_scale.R`

**Purpose**  
Processing of raw paired-end 16S rRNA amplicon sequencing data to generate high-quality ASVs (Amplicon Sequence Variants).

**Main steps**
- Quality inspection of raw FASTQ files  
- Primer identification and removal (cutadapt)  
- Quality filtering and trimming  
- ASV inference using **DADA2**  
- Chimera removal  
- Taxonomic assignment using **IDTAXA** (SILVA database)  
- Construction of ASV tables and sample metadata  
- Phylogenetic tree construction (Newick format)

**Input**
- Paired-end FASTQ files (16S rRNA V4 region)

**Output**
- `ASV_counts.tsv`  
- `ASV_identification.tsv`  
- `ASV.fasta`  
- `Information.tsv` (sample metadata)  
- Phylogenetic tree (`.newick`)

---

### 2. `02_microeco_community_analysis_large_scale.R`

**Purpose**  
Comprehensive microbial community ecology analysis based on ASV tables generated by DADA2, using the **microeco** framework.

**Main analyses**
- Taxonomic filtering and relative abundance calculation  
- Alpha diversity estimation and statistical testing  
- Differential abundance analysis (LEfSe)  
- Beta diversity analysis (Bray‚ÄìCurtis, UniFrac)  
- Ordination analyses (PCoA, RDA, dbRDA)  
- Co-occurrence network construction and module detection  
- Subset analyses by organ/tissue type

**Input**
- ASV count table  
- Taxonomic assignment table  
- Sample metadata  
- Phylogenetic tree

**Output**
- Alpha diversity tables and figures  
- Beta diversity ordinations  
- Differential taxa results  
- Network files (GEXF) and node/edge statistics

---

### 3. `03_sourcetracker_source_sink_analysis_Large_scale.R`

**Purpose**  
Source‚Äìsink inference of microbial communities using **SourceTracker v1** (Knights et al.).

In this analysis:
- **Bud-stage microbiomes** are treated as sources  
- **Flower, R3, and R5 stages** are treated as sinks  

The script estimates the proportional contribution of Bud-associated microbiomes to later developmental stages.

**Main steps**
- Import integer ASV count table and metadata  
- Define source and sink samples  
- Train SourceTracker model on source samples  
- Predict source contributions in sink samples  
- Summarize Bud and Unknown contributions by stage  
- Generate publication-ready visualizations

**Input**
- Integer ASV count table  
- Sample metadata with stage information

**Output**
- Source contribution tables (CSV)  
- Stage-wise mean ¬± SD summaries  
- Stacked bar plots (PNG / PDF)

---

### 4. `soybean_microbiome_phyloseq_analysis_small_scale.R`

**Purpose**  
Microbiome diversity and community structure analysis using **phyloseq**, applied to small-scale or subset datasets.

**Main analyses**
- Rarefaction curve analysis  
- Alpha diversity estimation (Observed, Chao1, Shannon, Simpson, etc.)  
- Statistical testing (Kruskal‚ÄìWallis, post-hoc tests)  
- Beta diversity analysis (Bray‚ÄìCurtis, PCoA, PERMANOVA)

**Input**
- OTU/ASV count table  
- Taxonomy table  
- Sample metadata

**Output**
- Alpha diversity statistics (CSV)  
- PERMANOVA results  
- Rarefaction, alpha diversity, and PCoA figures

---

## Recommended execution order

1. `01_dada2_processing_Large_scale.R`  
2. `02_microeco_community_analysis_large_scale.R`  
3. `03_sourcetracker_source_sink_analysis_Large_scale.R`  
4. `soybean_microbiome_phyloseq_analysis_small_scale.R` (optional / supplementary)

---

## Software and packages

- R (‚â• 4.2.0 recommended)
- **DADA2**
- **microeco**
- **phyloseq**
- **SourceTracker v1**
- Additional R packages are listed at the beginning of each script

---

## Code availability (for manuscript)

All scripts used for amplicon sequence processing, microbial community analyses, and source‚Äìsink inference are publicly available in this GitHub repository.

---
